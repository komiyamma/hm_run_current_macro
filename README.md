# HmRunCurrentMacro

![Hidemaru 9.35](https://img.shields.io/badge/Hidemaru-v9.35-6479ff.svg)

今、秀丸エディタで開いているマクロを実行するためのマクロです。

マクロの作成やテスト中に、その都度マクロを登録する手間を省くことができます。

## 機能

- 現在アクティブなウィンドウで開かれているマクロファイル（`.mac`）を実行します。
- 実行に失敗した場合、アウトプット枠にエラーメッセージを表示します。
- 無限ループを防ぐため、このマクロ自身を実行しようとするとエラーを表示します。

## 使い方

1. `HmRunCurrentMacro.mac` を秀丸のマクロディレクトリに配置します。
2. 秀丸エディタのメニューから `マクロ` → `マクロ登録` を選択し、このマクロを登録します。
3. `その他` → `キー割り当て` を選択し、登録したマクロに任意のショートカットキーを割り当てます。
4. テストしたいマクロファイルを開き、割り当てたショートカットキーを押すと、そのマクロが実行されます。

## エラー処理

以下の状況では、アウトプット枠にエラーメッセージが表示されます。（`HmOutputPane.dll` が必要です）

- **「何らかのマクロをファイルを開いて実行してください。」**
  - ファイルを開いていない状態で実行しようとした場合に表示されます。
- **「開かれているのがマクロファイルではないようです。」**
  - 現在開いているファイルの拡張子が `.mac` ではない場合に表示されます。
- **「この「HmRunCurrentMacro.mac」自体を実行することは出来ません。」**
  - このマクロ自身を実行しようとした場合に表示されます。

## 必須環境

- 秀丸エディタ v9.35 以降
- `HmOutputPane.dll` （通常は秀丸エディタに同梱されています）

## ライセンス

[MIT License](License.txt)

## 作者

Akitsugu Komiyama
